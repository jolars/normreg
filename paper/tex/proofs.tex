\section{Proofs}

\subsection{Proof of \Cref{thm:maxabs-gev}}

% TODO: We need to fix notation here. Either use subscript _j everywhere or abuse notation and define
% s = s_j etc.

If \(X_i \sim \normal(\mu, \sigma)\), then \(|X_i| \sim \fnormal(\mu,\sigma)\). By the
Fisher--Tippett--Gnedenko theorem, we know that \((\max_i |X_i| - b_n) / a_n\) converges in
distribution to either the Gumbel, Fréchet, or Weibull distribution, given a proper choice
of \(a_n > 0\) and \(b_n \in \mathbb{R}\). A sufficient condition for convergence to the
Gumbel distribution for a absolutely continuous cumulative distribution
function~\citep[Theorem 10.5.2]{nagaraja2003} is
\[
  \lim_{x \rightarrow \infty} \frac{d}{dx}\left(\frac{1- F(x)}{f(x)}\right) = 0.
\]
We have
\[
  \begin{aligned}
    \frac{1 - F_Y(x)}{f_Y(x)} & = \frac{1 - \frac{1}{2}\erf{\left(\frac{x - \mu}{\sqrt{2\sigma^2}}\right)} - \frac{1}{2}\erf{\left(\frac{x + \mu}{\sqrt{2\sigma^2}}\right)}}{\frac{1}{\sqrt{2\pi\sigma^2}}e^{\frac{-(x-\mu)^2}{2\sigma^2}} + \frac{1}{\sqrt{2\pi\sigma^2}}e^{\frac{-(x+\mu)^2}{2\sigma^2}}} \\
                              & = \frac{2 - \cdf\left(\frac{x - \mu}{\sigma}\right) - \cdf\left(\frac{x + \mu}{\sigma}\right)}{\frac{1}{\sigma}\left(\pdf\left(\frac{x - \mu}{\sigma}\right) + \pdf\left(\frac{x + \mu}{\sigma}\right)\right)}                                                              \\
                              & \rightarrow \frac{\sigma(1 - \cdf(x))}{\pdf(x)} \text{ as } n \rightarrow n,
  \end{aligned}
\]
where \(\pdf\) and \(\cdf\) are the probability distribution and cumulative density
functions of the standard normal distribution respectively. Next, we follow \citet[example
  10.5.3]{nagaraja2003} and observe that
\[
  \frac{d}{dx} \frac{\sigma(1 - \cdf(x))}{\pdf(x)} = \frac{\sigma x (1 - \cdf(x))}{\pdf(x)} - \sigma \rightarrow 0 \text{ as } x \rightarrow \infty
\]
since
\[
  \frac{1 - \cdf(x)}{\pdf(x)} \sim \frac{1}{x}.
\]
In this case, we may take \(b_n = F_Y^{-1}(1 - 1/n)\) and \(a_n = \big(n
f_Y(b_n)\big)^{-1}\).

\subsection{Proof of \Cref{thm:classbalance-bias}}\label{sec:classbalance-bias-proof}

To avoid excessive notation, we allow ourselves to abuse notation and will drop the
subscript \(j\) everywhere in this proof, allowing \(\beta^*\), \(s\), and so on to
respectively denote \(\beta^*\), \(s_j\) et cetera.

Since \(s = (q - q^2)^\delta\), we have
\begin{align*}
  \mu    & = \beta^* n (q - q^2)^{1 - \delta},                      & \frac{\theta}{\sigma} & = -a \sqrt{q - q^2} - b (q - q^2)^{\delta - 1/2},                                          \\
  \sigma & = \sigma_\varepsilon \sqrt{n} (q - q^2)^{1/2 - \delta},  & \frac{\gamma}{\sigma} & = a \sqrt{q - q^2} - b (q - q^2)^{\delta - 1/2},                                           \\
  d      & = n (q - q^2)^{1 - \delta} + \lambda_2 (q - q^2)^\delta, & \frac{\theta}{d}      & = \frac{-\beta^*n - \lambda_1 (q - q^2)^{\delta - 1}}{n + \lambda_2(q-q^2)^{2\delta - 1}}, \\
  \theta & = -\beta^* n (q - q^2)^{1-\delta} - \lambda_1,           & \frac{\gamma}{d}      & = \frac{\beta^*n - \lambda_1 (q - q^2)^{\delta - 1}}{n + \lambda_2(q-q^2)^{2\delta - 1}},  \\
  \gamma & = \beta^* n (q - q^2)^{1-\delta} - \lambda_1,
\end{align*}
with
\[
  a = \frac{\beta^* \sqrt{n}}{\sigma_\varepsilon} \qquad \text{and} \qquad b = \frac{\lambda_1}{\sigma_\varepsilon \sqrt{n}}.
\]

We are interested in
\begin{equation}
  \label{eq:eval-qlimit}
  \lim_{q \rightarrow 1^+} \E \hat{\beta} =\lim_{q \rightarrow 1^+}\frac{1}{d}\left(-\theta \cdf\left(\frac{\theta}{\sigma}\right) - \sigma \pdf\left(\frac{\theta}{\sigma}\right) + \gamma \cdf\left(\frac{\gamma}{\sigma}\right) + \sigma \pdf\left(\frac{\gamma}{\sigma}\right)\right).
\end{equation}
Before we proceed, note the following limits, which we will make repeated use of throughout the proof.
\begin{equation}
  \label{eq:eval-sigma-limits}
  \lim_{q \rightarrow 1^+} \frac{\theta}{\sigma} = \lim_{q \rightarrow 1^+} \frac{\gamma}{\sigma} =
  \begin{cases}
    -\infty & \text{if } 0 \leq \delta < \frac{1}{2}, \\
    -b      & \text{if } \delta = \frac{1}{2},        \\
    0       & \text{if } \delta > \frac{1}{2},
  \end{cases}
\end{equation}

Starting with the terms involving \(\cdf\) inside the limit in \Cref{eq:eval-qlimit}, for
now assuming that they are well-defined and that the limits of the remaining terms also
exist seperately, we have
\begin{align}
  \lim_{q \rightarrow 1^+} \left(-\frac{\theta}{d} \cdf\left(\frac{\theta}{\sigma}\right) + \frac{\gamma}{d} \cdf \left(\frac{\gamma}{\sigma}\right)\right)
   & = \lim_{q \rightarrow 1^+} \Bigg(\left(\frac{\beta^* n}{n + \lambda_2 (q-q^2)^{2\delta - 1}} + \frac{\lambda_1}{n(q-q^2)^{1-\delta} + \lambda_2 (q-q^2)^{\delta}} \right) \cdf \left(\frac{\theta}{\sigma}\right)  \nonumber                                                                                                                                                                                    \\
   & \phantom{= \lim_{q \rightarrow 1^+} \Bigg( } + \left(\frac{\beta^* n}{n + \lambda_2 (q-q^2)^{2\delta - 1}} - \frac{\lambda_1}{n(q-q^2)^{1-\delta} + \lambda_2 (q-q^2)^{\delta}} \right)\cdf \left(\frac{\gamma}{\sigma}\right) \Bigg) \nonumber                                                                                                                                                                 \\
   & = \lim_{q \rightarrow 1^+} \frac{\beta^*n}{n + \lambda_2 (q-q^2)^{2\delta - 1}}\left(\cdf \left(\frac{\theta}{\sigma}\right) + \cdf \left(\frac{\gamma}{\sigma}\right) \right)                                                                                                                                                                                                                        \nonumber \\
   & \phantom{={}} +  \lim_{q \rightarrow 1^+}\frac{\lambda_1}{n(q-q^2)^{1-\delta} + \lambda_2(q -q^2)^{\delta}} \left(\cdf \left(\frac{\theta}{\sigma}\right) - \cdf \left(\frac{\gamma}{\sigma}\right)\right). \label{eq:eval-qlimit-terms}
\end{align}
Considering the first term in \Cref{eq:eval-qlimit-terms}, we see that
\[
  \lim_{q \rightarrow 1^+} \frac{\beta^*n}{n + \lambda_2 (q-q^2)^{2\delta - 1}}\left(\cdf \left(\frac{\theta}{\sigma}\right) + \cdf \left(\frac{\gamma}{\sigma}\right) \right)  =
  \begin{cases}
    0                                          & \text{if } 0 \leq \delta < 1/2, \\
    \frac{2n \beta^*}{n + \lambda_2} \cdf (-b) & \text{if } \delta = 1/2,        \\
    \beta^*                                    & \text{if } \delta > 1/2.
  \end{cases}
\]
For the second term in \Cref{eq:eval-qlimit-terms}, we start by observing that if \(\delta
= 1\), then \((q - q^2)^{\delta - 1} = 1\), and if \(\delta > 1\), then
\(\lim_{q\rightarrow 1^+}(q - q^2)^{\delta - 1} = 0\). Moreover, the arguments of \(\cdf\)
approach 0 in the limit for \(\delta \geq 1\), which means that the entire term vanishes in
both cases (\(\delta \geq 1\)).

For \(0 \leq \delta < 1\), the limit is indeterminite of the form \(\infty \times 0\). We
define
\[
  f(q) = \cdf \left(\frac{\theta}{\sigma}\right) - \cdf \left(\frac{\gamma}{\sigma}\right)
  \qquad\text{and}\qquad
  g(q) = n(q - q^2)^{1-\delta} + \lambda_2(q - q^2)^\delta,
\]
such that we can express the limit as \(\lim_{q \rightarrow 1^+}f(q)/g(q)\). The
corresponding derivatives are
\[
  \begin{aligned}
    f'(q) & = \left(-\frac{a}{2}(1-2q)(q - q^2)^{-1/2} - b(\delta - 1/2)(1-2q)(q - q^2)^{\delta - 3/2}\right)\pdf\left(\frac{\theta}{\sigma}\right)                \\
          & \phantom{= {}} - \left(\frac{a}{2}(1-2q)(q - q^2)^{-1/2} - b(\delta - 1/2)(1-2q)(q - q^2)^{\delta - 3/2}\right)\pdf\left(\frac{\gamma}{\sigma}\right), \\
    g'(q) & = n(1 - \delta)(1-2q)(q - q^2)^{-\delta} + \lambda_2 \delta(1 - 2q) (q - q^2)^{\delta - 1}
  \end{aligned}
\]
Note that \(f(q)\) and \(g(q)\) are both differentiable and \(g'(q) \neq 0\) everywhere in
the interval \((1/2, 1)\). Now note that we have
\begin{multline}
  \label{eq:eval-qlimit-secondterm}
  \frac{f'(q)}{g'(q)} = \frac{1}{n(1-\delta)(q-q^2)^{1/2-\delta} + \lambda_2 \delta (1-2q)(q - q^2)^{\delta-1/2}} \\
  \times \left(-\left(\frac{a}{2} + b(\delta - 1/2)(q - q^2)^{\delta - 1}\right)\pdf\left(\frac{\theta}{\sigma}\right) - \left(\frac{a}{2} - b(\delta - 1/2)(q - q^2)^{\delta - 1}\right)\pdf\left(\frac{\gamma}{\sigma}\right) \right).
\end{multline}
For \(0 \leq \delta < 1/2\), $\lim_{q \rightarrow 1^+}f'(q)/g'(q) = 0$ since the exponential terms of \(\pdf\) in \Cref{eq:eval-qlimit-secondterm} dominate in the limit.

For \(\delta = 1/2\), we have
\[
  \lim_{q \rightarrow 1^+} \frac{f'(q)}{g'(q)} = -\frac{a}{n + \lambda_2} \lim_{q \rightarrow 1^+}\left(\pdf\left(\frac{\theta}{\sigma}\right) + \pdf\left(\frac{\gamma}{\sigma}\right)\right) = -\frac{2a \pdf(-b)}{n + \lambda_2}
\]
so that we can use L'Hôpital's rule to show that the second term in
\Cref{eq:eval-qlimit-terms} becomes
\begin{equation}
  \label{eq:eval-qlimit-stdcase}
  -\frac{2\beta^*\lambda_1\sqrt{n}}{\sigma_\varepsilon(n + \lambda_2)} \pdf\left(\frac{-\lambda_1}{\sigma_\varepsilon\sqrt{n}}\right).
\end{equation}

For \(\delta > 1/2\), we have
\[
  \begin{aligned}
    \lim_{q \rightarrow 1^+} \frac{f'(q)}{g'(q)} & = \lim_{q \rightarrow 1^+} \frac{-\frac{a}{2}\left(\pdf\left(\frac{\theta}{\sigma}\right) + \pdf\left(\frac{\gamma}{\sigma}\right)\right)}{n(1-\delta)(q - q^2)^{1/2 - \delta} + \lambda_2 \delta(1 - 2q)(q - q^2)^{\delta - 1/2}}                                                       \\
                                                 & \phantom{= {}} + \lim_{q \rightarrow 1^+} \frac{b(\delta - 1/2)\left(\pdf\left(\frac{\gamma}{\sigma}\right) - \pdf\left(\frac{\theta}{\sigma}\right)\right)}{n(1 - \delta)(q - q^2)^{3/2 - 2\delta} + \lambda_2 \delta (1 - 2q)(q - q^2)^{1/2}}                                          \\
                                                 & = 0 + \lim_{q \rightarrow 1^+} \frac{b(\delta - 1/2) e^{-\frac{1}{2}\left(a^2(q - q^2) + b^2(q - q^2)^{2\delta - 1}\right)}\left(e^{-ab(q-q^2)^\delta} - e^{ab(q-q^2)^\delta}\right)}{\sqrt{2\pi}\left(n(1-\delta)(q - q^2)^{3/2 - 2\delta} + \lambda_2\delta(1-2q)(q-q^2)^{1/2}\right)} \\
                                                 & = 0
  \end{aligned}
\]
since the exponential term in the numerator dominates.

Now we proceed to consider the terms involving \(\pdf\) in \Cref{eq:eval-qlimit}. We have
\begin{equation}
  \label{eq:eval-qlimit-pdfterm}
  \lim_{q \rightarrow 1^+} \frac{\sigma}{d} \left(\pdf \left(\frac{\gamma}{\sigma}\right) - \pdf \left(\frac{\theta}{\sigma}\right)\right)
  = \sigma_\varepsilon \sqrt{n} \lim_{q \rightarrow 1^+} \frac{ \pdf\left(\frac{\gamma}{\sigma}\right) - \pdf\left(\frac{\theta}{\sigma}\right)}{n(q-q^2)^{1/2} + \lambda_2(q - q^2)^{2\delta - 1/2}}
\end{equation}
For \(0 \leq \delta < 1/2\), we observe that the exponential terms in \(\pdf\) dominate in the limit, and so we can distribute the limit and consider the limits of the respective terms individually, which both vanish.

For \(\delta \geq 1/2\), the limit in \Cref{eq:eval-qlimit-pdfterm} has an indeterminate
form of the type \(\frac{0}{0}\). Define
\[
  u(q) = \pdf\left(\frac{\gamma}{\sigma}\right) - \pdf\left(\frac{\theta}{\sigma}\right)
  \qquad\text{and}\qquad
  v(q) = n(q - q^2)^{1/2} + \lambda_2 (q - q^2)^{2\delta - 1/2}
\]
which are both differentiable in the interval \((1/2, 1)\) and \(v'(q) \neq 0\) everywhere
in this interval. The derivatives are
\[
  \begin{aligned}
    u'(q) & = -\pdf\left(\frac{\gamma}{\sigma}\right)\frac{\gamma}{\sigma} \left(\frac{1}{2}\left(a(1-2q)(q - q^2)^{-1/2}\right) - b(\delta - 1/2)(1- 2q)(q - q^2)^{\delta - 3/2}\right)                 \\
          & \phantom{= {}} + \pdf\left(\frac{\theta}{\sigma}\right) \frac{\theta}{\sigma} \left(\frac{1}{2}\left(a(1-2q)(q - q^2)^{-1/2}\right) + b(\delta - 1/2)(1- 2q)(q - q^2)^{\delta - 3/2}\right), \\
    v'(q) & = \frac{n}{2} (1 - 2q)(q - q^2)^{-1/2} + \lambda_2(2\delta - 1/2)(1 - 2q)(q - q^2)^{2\delta - 3/2}.
  \end{aligned}
\]
And so
\begin{equation}
  \begin{split}
    \frac{u'(q)}{v'(q)} = \frac{1}{n + \lambda_2(4\delta - 1)(q - q^2)^{2\delta - 1}}  \Bigg( & \left(a - b(2\delta - 1)(q - q^2)^{\delta - 1}\right) \pdf\left(\frac{\gamma}{\sigma}\right) \frac{\gamma}{\sigma} \\ & + \left(a + b(2\delta - 1)(q - q^2)^{\delta - 1}\right)\pdf\left(\frac{\theta}{\sigma}\right) \frac{\theta}{\sigma}\Bigg).
  \end{split}
\end{equation}
Taking the limit, rearranging, and assuming that the limits of the separate terms exist, we obtain
\begin{multline}
  \label{eq:eval-qlimit-pdfterm-split}
  \lim_{q \rightarrow 1^+} \frac{u'(q)}{v'(q)} = a \lim_{q \rightarrow 1^+}  \frac{1}{n + \lambda_2 (4 \delta - 1)(q - q^2)^{2\delta - 1}} \left( \pdf\left(\frac{\gamma}{\sigma}\right)\frac{\gamma}{\sigma} - \pdf\left(\frac{\theta}{\sigma}\right)\frac{\theta}{\sigma}\right) \\
  + b (2\delta - 1) \lim_{q \rightarrow 1^+} \frac{1}{n + \lambda_2 (4 \delta - 1)(q - q^2)^{2\delta - 1}} \bigg( \pdf\left(\frac{\gamma}{\sigma}\right) \left(a(q -q^2)^{\delta - 1/2}- b(q - q^2)^{2\delta - 3/2} \right) \\
  - \pdf\left(\frac{\theta}{\sigma}\right) \left(-a(q - q^2)^{\delta - 1/2} - b(q - q^2)^{2\delta - 3/2}\right) \bigg).
\end{multline}
For \(\delta = 1/2\), we have
\[
  \lim_{q \rightarrow 1^+} \frac{u'(q)}{v'(q)} = -\frac{a}{n + \lambda_2}\left(-b \pdf(-b) - b \pdf(-b)\right) + 0 = 2ab \pdf(-b) = \frac{2 \beta^* \lambda_1}{\sigma_\varepsilon^2(n + \lambda_2)} \pdf \left(\frac{-\lambda_1}{\sigma_\varepsilon\sqrt{n}}\right).
\]
Using L'Hôpital's rule, \Cref{eq:eval-qlimit-pdfterm} must consequently be
\[
  \frac{2 \beta^* \lambda_1\sqrt{n}}{\sigma_\varepsilon(n + \lambda_2)} \pdf \left(\frac{-\lambda_1}{\sigma_\varepsilon\sqrt{n}}\right),
\]
which cancels with \Cref{eq:eval-qlimit-stdcase}.

For \(\delta > 1/2\), we first observe that the first term in
\Cref{eq:eval-qlimit-pdfterm-split} tends to zero due to \Cref{eq:eval-sigma-limits} and
the properties of the standard normal distribution. For the second term, we note that this
is essentially of the same form as \Cref{eq:eval-qlimit-secondterm} and that the limit is
therefore 0 here.

\subsection{Proof of \Cref{thm:classbalance-variance}}\label{sec:classbalance-variance-proof}

The variance of the elastic net estimator is given by
\begin{multline}
  \label{eq:varthm-var}
  \var \hat{\beta}_j = \frac{1}{d^2}\Bigg( \frac{\sigma^2}{2}\bigg(2 + \erf\left(\frac{\theta}{\sigma \sqrt{2}}\right) - \frac{\theta}{\sigma}\sqrt{\frac{2}{\pi}} \exp\left(-\frac{\theta^2}{2\sigma^2}\right) + \erf\left(\frac{\gamma}{\sigma\sqrt{2}}\right) - \frac{\gamma}{\sigma} \sqrt{\frac{2}{\pi}} \exp\left(- \frac{\gamma^2}{2\gamma^2}\right)\bigg) \\
  + 2\theta\sigma \pdf\left(\frac{\theta}{\sigma}\right) + \theta^2 \cdf\left(\frac{\theta}{\sigma}\right) + 2\gamma \sigma \pdf\left(\frac{\gamma}{\sigma}\right) + \gamma^2 \cdf\left(\frac{\gamma}{\sigma}\right) \Bigg)
  - \left(\frac{1}{d}\E \hat{\beta}_j\right)^2.
\end{multline}
We start by noting the following identities:
\[
  \begin{aligned}
    \theta^2                  & = \left(\beta^* n\right)^2 (q-q^2)^{2-2\delta} + \lambda_1^2 + 2\lambda_1 \beta^* n(q-q^2)^{1-\delta},                \\
    d^2                       & = n^2(q -q^2)^{2 - 2\delta} + 2n\lambda_2 (q-q^2) + \lambda_2^2 (q-q^2)^{2\delta},                                    \\
    \theta \sigma             & =  -\sigma_\varepsilon\left(\beta^* n^{3/2}(q- q^2)^{3/2-2\delta} + \sqrt{n} \lambda_1 (q-q^2)^{1/2 - \delta}\right), \\
    \frac{\theta^2}{\sigma^2} & = a^2(q-q^2) + b^2(q-q^2)^{2\delta - 1} + 2ab (q -q^2)^\delta,                                                        \\
    \frac{\sigma}{d}          & = \frac{\sigma_\varepsilon \sqrt{n}}{n(q-q^2)^\frac{1}{2} + \lambda_2 (q-q^2)^{2\delta - 1/2}}.
  \end{aligned}
\]
Expansions involving \(\gamma\) instead of \(\theta\) have identical expansions up to sign
changes of the individual terms. Also recall the definitions provided in the proof of
\Cref{thm:classbalance-bias}.

Starting with the case when \(0 \leq \delta < 1/2\), we write the limit of
\Cref{eq:varthm-var} as
\begin{align*}
   & \lim_{q \rightarrow 1^+} \var \hat{\beta}_j                                                                                                                                                                                                                                                                                                                                         \\ & = \sigma_\varepsilon^2 n  \lim_{q \rightarrow 1^+} \frac{1}{\left(n(q-q^2)^{1/2} + \lambda_2(q-q^2)^{2\delta - 1/2}\right)^2}\bigg(1 + \erf\left(\frac{\theta}{\sigma \sqrt{2}}\right) - \frac{\theta}{\sigma}\sqrt{\frac{2}{\pi}} \exp\left(-\frac{\theta^2}{2\sigma^2}\right)\bigg)                                                                                               \\
   & \phantom{= {}} + \sigma_\varepsilon^2 n  \lim_{q \rightarrow 1^+} \frac{1}{\left(n(q-q^2)^{1/2} + \lambda_2(q-q^2)^{2\delta - 1/2}\right)^2}\bigg(1 + \erf\left(\frac{\gamma}{\sigma\sqrt{2}}\right) - \frac{\gamma}{\sigma} \sqrt{\frac{2}{\pi}} \exp\left(- \frac{\gamma^2}{2\sigma^2}\right)\bigg)                                                                               \\
   & \phantom{= {}}+ \lim_{q \rightarrow 1^+} \frac{2\theta\sigma}{d^2} \pdf\left(\frac{\theta}{\sigma}\right) + \lim_{q \rightarrow 1^+} \frac{\theta^2}{d^2} \cdf\left(\frac{\theta}{\sigma}\right) + \lim_{q \rightarrow 1^+} \frac{2\gamma}{d^2} \sigma \pdf\left(\frac{\gamma}{\sigma}\right) + \lim_{q \rightarrow 1^+}\frac{\gamma^2}{d^2} \cdf\left(\frac{\gamma}{\sigma}\right) \\
   & \phantom{= {}}- \left( \lim_{q\rightarrow 1^+}\frac{1}{d}\E \hat{\beta}_j\right)^2,
\end{align*}
assuming, for now, that all limits exist. Next, let
\[
  \begin{aligned}
    f_1(q) & = 1 + \erf\left(\frac{\theta}{\sigma\sqrt{2}}\right) - \frac{\theta}{\sigma}\sqrt{\frac{2}{\pi}} \exp\left(-\frac{\theta^2}{2\sigma^2}\right) , \\
    f_2(q) & = 1 + \erf\left(\frac{\gamma}{\sigma\sqrt{2}}\right) - \frac{\gamma}{\sigma}\sqrt{\frac{2}{\pi}} \exp\left(-\frac{\gamma^2}{2\sigma^2}\right) , \\
    g(q)   & = \left(n^2(q-q^2) + 2n \lambda_2 (q-q^2)^{2\delta} + \lambda_2^2 (q-q^2)^{4\delta - 1}\right)^2.
  \end{aligned}
\]
And
\begin{align*}
  f_1'(q) & = \frac{\theta^2}{\sigma^2}\sqrt{\frac{2}{\pi}}\exp\left(-\frac{\theta^2}{2\sigma^2}\right),                                    \\
  f_2'(q) & = \frac{\gamma^2}{\sigma^2}\sqrt{\frac{2}{\pi}}\exp\left(-\frac{\gamma^2}{2\sigma^2}\right),                                    \\
  g'(q)   & = (1-2q)\left((q-q^2)^{-1} + 4n\delta \lambda_2 (q-q^2)^{2\delta - 1} + \lambda_2^2 (4 \delta - 1)(q-q^2)^{4\delta - 2}\right).
\end{align*}
\(f_1\), \(f_1\) and \(g\) are differentiable in \((1/2, 1)\) and \(g'(q) \neq 0\) everywhere in this interval. \(f_1/g\) and \(f_2/g\) are indeterminate of the form \(0/0\). And we see that
\[
  \lim_{q \rightarrow 1^+} \frac{f_1'(q)}{g'(q)} = \lim_{q \rightarrow 1^+} \frac{f_2'(q)}{g'(q)} = 0
\]
due to the dominance of the exponential terms as \(\theta/\sigma\) and \(\gamma/\sigma\)
both tend to \(-\infty\). Thus \(f_1/g\) and \(f_2/g\) also tend to 0 by L'Hôpital's rule.
Similar reasoning shows that
\[
  \lim_{q \rightarrow 1^+} \frac{2\theta \sigma}{d^2} \pdf \left(\frac{\theta}{\sigma}\right) = \lim_{q \rightarrow 1^+} \frac{\theta^2}{d^2} \cdf \left(\frac{\theta}{\sigma}\right) = 0.
\]
The same result applies to the respective terms involving \(\gamma\). And since we in
\Cref{thm:classbalance-bias} showed that \(\lim_{q\rightarrow 1^+} \frac{1}{d} \E
\hat{\beta}_j = 0\), the limit of \Cref{eq:varthm-var} must be 0.

For \(\delta = 1/2\), we start by establishing that
\begin{equation}
  \label{eq:var-deltahalf-integral}
  \lim_{q \rightarrow 1^+} \int_{-\infty}^{-\lambda}(z+ \lambda)^2 f_Z(z) \du z = \lim_{q \rightarrow 1^+} \left(\sigma^2 \int_{-\infty}^\frac{\theta}{\sigma} y^2 \pdf(y) \du y + 2 \theta \sigma \int_{-\infty}^\frac{\theta}{\sigma} y \pdf(y) \du y + \theta^2 \int_{-\infty}^\frac{\theta}{\sigma} \pdf(y) \du y\right)
\end{equation}
is a positive constant since \(\theta/\sigma \rightarrow -b\), \(\sigma =
\sigma_\varepsilon \sqrt{n}\), \(\theta \rightarrow - \lambda\), and \(\theta\sigma
\rightarrow - \sigma_\varepsilon \sqrt{n}\lambda\). An identical argument can be made in
the case of \(\lim_{q \rightarrow 1^+} \int_{\lambda}^{\infty}(z - \lambda)^2 f_Z(z) \du
z.\) We then have
\[
  \lim_{q \rightarrow 1^+} \frac{1}{d^2} \int_{-\infty}^{-\lambda}(z+ \lambda)^2 f_Z(z) \du z = \frac{C^+}{\lim_{q\rightarrow 1^+} d^2} = \frac{C^+}{0} = \infty,
\]
where \(C^+\) is some positive constant. And because \(\lim_{q\rightarrow 1^+} \frac{1}{d}
\E \hat{\beta}_j = \beta^*\)~(\Cref{thm:classbalance-bias}), the limit of
\Cref{eq:varthm-var} must be \(\infty\).

Finally, for the case when \(\delta > 1/2\), we have
\begin{multline}
  \label{eq:var-deltagthalf-integral}
  \lim_{q \rightarrow 1^+} \frac{1}{d^2} \left(\sigma^2 \int_{-\infty}^\frac{\theta}{\sigma} y^2 \pdf(y) \du y + 2 \theta \sigma \int_{-\infty}^\frac{\theta}{\sigma} y \pdf(y) \du y + \theta^2 \int_{-\infty}^\frac{\theta}{\sigma} \pdf(y) \du y\right) \\
  = \lim_{q \rightarrow 1^+} \Bigg( \frac{n \sigma^2}{ \left(n (q-q^2)^{1/2} + \lambda_2(q-q^2)^{2\delta - 1/2}\right)^2} \int_{-\infty}^\frac{\theta}{\sigma} y^2 \pdf(y) \du y
  \\- \frac{2\sigma_\varepsilon \sqrt{n}\left(\beta^* n (q- q^2)^{1 - \delta} - \lambda_1\right)}{\left(n(q-q^2)^{3/4 - \delta/2} + \lambda_2(q-q^2)^{3\delta / 2 - 1/4}\right)^2} \int_{-\infty}^\frac{\theta}{\sigma} y \pdf(y) \du y \\
  + \left(\frac{-\beta^*n(q-q^2)^{1-\delta} - \lambda_1}{n(q-q^2)^{1-\delta} + \lambda_2(q-q^2)^\delta}\right)^2 \int_{-\infty}^\frac{\theta}{\sigma} \pdf(y) \du y\Bigg).
\end{multline}
Inspection of the exponents involving the factor \((q - q^2)\) shows that the first term inside the limit will dominate. And since the upper limit of the integrals, \(\theta/\sigma \rightarrow  0\)  as \(q \rightarrow 1^+\), the limit must be \(\infty\).

\subsection{Proof of \Cref{cor:ridge-variance}}

We have
\begin{equation*}
  \lim_{q\rightarrow 1^+}\var \hat{\beta}_j = \lim_{q \rightarrow 1^+}\frac{\sigma^2}{d^2} \left(\frac{\sigma_\varepsilon \sqrt{n} (q - q^2)^{1/2 - \delta}}{n (q-q^2)^{1 - \delta} + \lambda_2 (q-q^2)^\delta}\right)^2
  = \frac{\sigma_\varepsilon^2 n}{\lambda_2^2} \lim_{q \rightarrow 1^+}(q-q^2)^{1 - 4\delta},
\end{equation*}
from which the result follows directly.

\subsection{Proof of \Cref{thm:weighted-elasticnet-bias}}

Our proof follows a similar structure as in the proof for \Cref{thm:classbalance-bias}
(\Cref{sec:classbalance-bias-proof}). We start by noting the values of some of the
important terms. As before we will drop the subscript \(j\) everywhere to simplify
notation. We have
\begin{align*}
  \mu    & = \beta^*(q -q^2)^\omega,                     & \frac{\theta}{\sigma} & = -a\sqrt{q-q^2} - b(q-q^2)^{\omega - 1/2},                                           \\
  \sigma & = \sigma_\varepsilon \sqrt{n(q-q^2)},         & \frac{\gamma}{\sigma} & = a\sqrt{q-q^2} - b(q-q^2)^{\omega - 1/2},                                            \\
  d      & = n(q-q^2) + \lambda_2(q-q^2)^\omega.\,       & \frac{\theta}{d}      & = \frac{-\beta^*n - \lambda_1(q-q^2)^{\omega - 1}}{n + \lambda_2(q-q^2)^{\omega -1}}, \\
  \theta & = -\beta^*n(q-q^2) - \lambda_1(q-q^2)^\omega, & \frac{\gamma}{d}      & = \frac{\beta^*n - \lambda_1(q-q^2)^{\omega - 1}}{n + \lambda_2(q-q^2)^{\omega -1}},  \\
  \gamma & = \beta^*n(q-q^2) - \lambda_1(q-q^2)^\omega.
\end{align*}

First note the following limit (which is analogous to that in \Cref{eq:eval-sigma-limits}).
\begin{equation}
  \label{eq:eval-sigma-limits-weighted}
  \lim_{q \rightarrow 1^+} \frac{\theta}{\sigma} = \lim_{q \rightarrow 1^+} \frac{\gamma}{\sigma} =
  \begin{cases}
    -\infty & \text{if } 0 \leq \omega < \frac{1}{2}, \\
    -b      & \text{if } \omega = \frac{1}{2},        \\
    0       & \text{if } \omega > \frac{1}{2}.
  \end{cases}
\end{equation}

As in \Cref{sec:classbalance-bias-proof}, we are looking to compute the following limit:
\begin{equation}
  \label{eq:eval-qlimit-weighted}
  \lim_{q \rightarrow 1^+} \E \hat{\beta} =\lim_{q \rightarrow 1^+}\frac{1}{d}\left(-\theta \cdf\left(\frac{\theta}{\sigma}\right) - \sigma \pdf\left(\frac{\theta}{\sigma}\right) + \gamma \cdf\left(\frac{\gamma}{\sigma}\right) + \sigma \pdf\left(\frac{\gamma}{\sigma}\right)\right).
\end{equation}

Starting with the terms involving \(\cdf\) and assuming that the limit can be distributed,
we have
\begin{align}
  \lim_{q \rightarrow 1^+} \left(-\frac{\theta}{d} \cdf\left(\frac{\theta}{\sigma}\right) + \frac{\gamma}{d} \cdf \left(\frac{\gamma}{\sigma}\right)\right)
   & = \lim_{q\rightarrow 1^+} \frac{\beta^* n + \lambda_1(q-q^2)^{\omega -1}}{n + \lambda_2(q-q^2)^{\omega - 1}}\cdf\left(\frac{\theta}{\sigma}\right) \nonumber                \\
   & \phantom{= {}} + \lim_{q\rightarrow 1^+} \frac{\beta^* n - \lambda_1(q-q^2)^{\omega -1}}{n + \lambda_2(q-q^2)^{\omega - 1}}\cdf\left(\frac{\gamma}{\sigma}\right) \nonumber \\
   & =\begin{cases}
        0                              & \text{if } 0 \leq \omega < 1, \\
        \frac{\beta^*n}{n + \lambda_2} & \text{if } \omega = 1,        \\
        \beta^*                        & \text{if } \omega > 1.
      \end{cases} \label{eq:eval-qlimit-terms-weighted}
\end{align}

The derivation of the first case in \Cref{eq:eval-qlimit-terms-weighted} depends on
\(\omega\). For \(0 \leq \omega \leq 1/2\), it stems from the facts that
\(\cdf(\theta/\sigma) \rightarrow 0\) and \(\cdf(\theta/\sigma) \rightarrow 0\) as \(q
\rightarrow 1^+\) together with the existence of the \((q-q^2)^{\omega - 1}\) factor in
both numerator and denominator. For \(1/2 \leq \omega < 1\), the terms cancel each other
out. In the second case, when \(\omega = 1\), the result stems from \(\cdf(\theta/\sigma)\)
and \(\cdf(\gamma/\sigma)\) both tending to 1/2 as \(q \rightarrow 1^+\). And finally for
\(\omega > 1\), the terms involving the \((q-q^2)^{\omega - 1}\) factors vanish and again
the values of the cumulative distribution functions tend to 1/2.

Now, we turn to the terms involving the probability density function \(\pdf\). Again, we
assume the limit is distributive so that
\begin{equation}
  \label{eq:eval-qlimit-pdf-weighted}
  \lim_{q \rightarrow 1^+} \frac{\sigma}{d} \left(\pdf\left(\frac{\gamma}{\sigma}\right) - \left(\frac{\theta}{\sigma}\right)\right) =
  \lim_{q\rightarrow 1^+}\frac{\sigma}{d} \pdf \left(\frac{\gamma}{\sigma}\right) - \lim_{q \rightarrow 1^+} \frac{\sigma}{d} \pdf \left(\frac{\theta}{\sigma}\right).
  % \sigma_\varepsilon \sqrt{n} \lim_{q \rightarrow 1^+} \frac{\pdf\left(\frac{\gamma}{\sigma}\right) - \pdf\left(\frac{\theta}{\sigma}\right)}{n(q-q^2)^{1/2} + \lambda_2(q-q^2)^{\omega - 1/2}}.
\end{equation}
%
Starting with the first term on the right-hand side of \Cref{eq:eval-qlimit-pdf-weighted},
we have
%
\[
  \lim_{q\rightarrow 1^+}\frac{\sigma}{d} \pdf \left(\frac{\gamma}{\sigma}\right) =
  \frac{\sigma_\varepsilon \sqrt{n} \pdf\left(\frac{\gamma}{\sigma}\right)}{n(q-q^2)^{1/2} + \lambda_2(q-q^2)^{\omega - 1/2}}.
\]
For \(0 \leq \omega < 1/2\), this limit is 0 since the exponential terms in the numerator
will dominate as \(q \rightarrow 1^+\). For \(\omega = 1/2\), we have the limit
\(\sigma_\varepsilon\sqrt{n} \pdf(-b)/\lambda_2\). For \(\omega > 1/2\), the limit is
indeterminate of the type \(0/0\). Let
\begin{equation*}
  f_1(q) = \pdf\left(\frac{\gamma}{\sigma}\right)
  \qquad\text{and}\qquad
  g(q) = n(q-q^2)^{1/2} + \lambda_2(q-q^2)^{\omega - 1/2}
\end{equation*}
%
and observe that \(f_1\) and \(g\) are differentiable and \(g'(q) \neq 0 \) for \(q \in
(1/2, 1)\). The derivatives are
%
\begin{align*}
  f_1'(q) & = -\left(\frac{a}{2}(1-2q)(q-q^2)^{-1/2} - b(\omega - 1/2)(1-2q)(q-q^2)^{\omega - 3/2}\right) \frac{\gamma}{\sigma} \pdf\left(\frac{\gamma}{\sigma}\right), \\
  g'(q)   & = \frac{n}{2}(1-2q)(q-q^2)^{-1/2} + \lambda_2(\omega - 1/2)(1-2q)(q-q^2)^{\omega - 3/2}.
\end{align*}
%
Next, we find that
\begin{equation}
  \label{eq:eval-qlimit-pdf-derivative-weighted}
  \frac{f_1'(q)}{g'(q)} = \frac{-a + b(2\omega - 1)(q-q^2)^{\omega - 1}}{n + \lambda_2(2\omega - 1)(q-q^2)^{\omega - 1}} \left(\frac{\gamma}{\sigma}\right) \pdf\left(\frac{\gamma}{\sigma}\right).
\end{equation}
%
Taking the limit of \Cref{eq:eval-qlimit-pdf-derivative-weighted} and invoking L'Hôpital's
rule yields
\[
  \lim_{q\rightarrow 1^+} \frac{f_1'(q)}{g'(q)} =0
\]
both when \(1/2 < \omega < 1\) and \(\omega \geq 1\) since \(\gamma/\sigma\) tends to 0 as
\(q \rightarrow 1^+\) for \(\omega > 1/2\) and the \(\pdf\) term tends to a constant, plus
the fact that the remaining factor in the expression also tends to a constant since the
terms involving \((q-q^2)^{\omega - 1}\) vanish when \(\omega > 1\), are constant when
\(\omega = 1\), and cancel each other out in the limit when \(\omega < 1\).

Finally, if we now consider the second term on the right-hand side of
\Cref{eq:eval-qlimit-pdf-weighted}, set \(f_2(q) = \pdf(\theta/\sigma)\), and perform the
same steps as above, we find that the limits are the same in all cases, which means that
the limits in \Cref{eq:eval-qlimit-pdf-weighted} cancel in the case when \(\omega = 1/2\)
and therefore that
\[
  \lim_{q \rightarrow 1^+} \frac{\sigma}{d} \left(\pdf\left(\frac{\gamma}{\sigma}\right) - \left(\frac{\theta}{\sigma}\right)\right) = 0
\]
for \(0 \leq \omega \). The limit in \Cref{eq:eval-qlimit-weighted} is given by
\Cref{eq:eval-qlimit-terms-weighted}.

\subsection{Proof of \Cref{thm:weighted-elasticnet-variance}}

This proof is in many ways equivalent to that in the case of variance of the normalized
unweighted elastic net (\Cref{sec:classbalance-variance-proof}) and we therefore omit many
of the details here.

In the case of \(0 \leq \omega < 1/2\), the proof is simplified since the \(d^2\) term
tends to \(\infty\) whilst the numerator takes the same limit as in the normalized case,
which means that the limit is \(0\) in this case. For \(\omega = 1/2\), we consider
\Cref{eq:var-deltahalf-integral} and observe that it again tends to a positive constant
whilst \(\lim_{q\rightarrow 1^+} d^2 = 0\), which means that the limit of the expression,
and hence variance of the estimator, tends to \(\infty\). For \(\omega > 1/2\), an
identical argument for the expression in \Cref{eq:var-deltagthalf-integral} holds and the
limit is therefore \(\infty\) in this case as well.

